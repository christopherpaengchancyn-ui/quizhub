<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Settings - QuizHub</title>
<style>
*{box-sizing:border-box;}
body{font-family:Arial,sans-serif;background:#0f1112;color:#cfc5b8;display:flex;justify-content:center;align-items:flex-start;min-height:100vh;margin:0;padding:20px 15px;}
.card{background:#24201c;padding:30px;border-radius:14px;width:100%;max-width:450px;box-shadow:0 6px 30px rgba(2,2,2,0.6);}
@media(max-width:480px){.card{padding:20px;}}
h2{color:#d9b78a;margin:0 0 20px 0;text-align:center;}
.section{margin:20px 0;padding:15px;background:rgba(255,255,255,0.03);border-radius:12px;}
.section-title{color:#d9b78a;font-size:14px;font-weight:600;margin-bottom:15px;display:flex;align-items:center;gap:8px;}
.setting-row{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.05);}
.setting-row:last-child{border-bottom:none;}
.setting-label{color:#cfc5b8;font-size:14px;}
.toggle{position:relative;width:50px;height:26px;cursor:pointer;}
.toggle input{opacity:0;width:0;height:0;}
.toggle-slider{position:absolute;top:0;left:0;right:0;bottom:0;background:#3a3632;border-radius:26px;transition:0.3s;}
.toggle-slider:before{content:'';position:absolute;height:20px;width:20px;left:3px;bottom:3px;background:#cfc5b8;border-radius:50%;transition:0.3s;}
.toggle input:checked + .toggle-slider{background:linear-gradient(90deg,#b68b5a,#d9b78a);}
.toggle input:checked + .toggle-slider:before{transform:translateX(24px);background:#fff;}
.btn{width:100%;padding:12px;margin-top:10px;border-radius:10px;border:none;background:linear-gradient(90deg,#b68b5a,#d9b78a);color:#fff;font-weight:600;cursor:pointer;transition:transform 0.2s;font-size:14px;}
.btn:hover{transform:scale(1.02);}
.btn-secondary{background:#3a3632;margin-top:8px;}
.btn-danger{background:linear-gradient(90deg,#b65a5a,#d98a8a);}
.edit-input{width:100%;padding:10px;border-radius:8px;border:none;background:#1a1817;color:#cfc5b8;margin:8px 0;font-size:14px;}
.edit-section{display:none;margin-top:10px;padding-top:10px;border-top:1px solid rgba(255,255,255,0.1);}
.edit-section.show{display:block;}
.current-value{color:rgba(255,255,255,0.5);font-size:12px;margin-top:3px;}
.action-btn{background:none;border:1px solid rgba(255,255,255,0.2);color:#d9b78a;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:12px;transition:all 0.2s;}
.action-btn:hover{background:rgba(255,255,255,0.05);border-color:#d9b78a;}
.footer{text-align:center;padding:20px 15px;margin-top:20px;border-top:1px solid rgba(255,255,255,0.1);font-size:12px;color:rgba(255,255,255,0.4);}
.footer-line{margin:5px 0;}
.success-msg{color:#4ade80;font-size:12px;margin-top:5px;display:none;}
</style>
</head>
<body>
<div class="card">
  <h2>‚öôÔ∏è Settings</h2>

  <!-- Sound Settings -->
  <div class="section">
    <div class="section-title">üîä Sound</div>
    <div class="setting-row">
      <span class="setting-label">Sound Effects</span>
      <label class="toggle">
        <input type="checkbox" id="soundEffects" onchange="toggleSoundEffects()">
        <span class="toggle-slider"></span>
      </label>
    </div>
    <div class="setting-row">
      <span class="setting-label">Background Music</span>
      <label class="toggle">
        <input type="checkbox" id="bgMusic" onchange="toggleBgMusic()">
        <span class="toggle-slider"></span>
      </label>
    </div>
  </div>

  <!-- Account Settings -->
  <div class="section">
    <div class="section-title">üë§ Account</div>
    
    <!-- Change Name -->
    <div class="setting-row" style="flex-direction:column;align-items:stretch;">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <span class="setting-label">Name</span>
          <div class="current-value" id="currentName">-</div>
        </div>
        <button class="action-btn" onclick="toggleEditName()">Edit</button>
      </div>
      <div class="edit-section" id="editNameSection">
        <input type="text" class="edit-input" id="newName" placeholder="Enter new name">
        <button class="btn" onclick="saveName()">Save Name</button>
        <div class="success-msg" id="nameSuccess">‚úì Name updated!</div>
      </div>
    </div>

    <!-- Change Password -->
    <div class="setting-row" style="flex-direction:column;align-items:stretch;margin-top:10px;">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <span class="setting-label">Password</span>
        <button class="action-btn" onclick="toggleEditPassword()">Change</button>
      </div>
      <div class="edit-section" id="editPasswordSection">
        <input type="password" class="edit-input" id="currentPass" placeholder="Current password">
        <input type="password" class="edit-input" id="newPass" placeholder="New password">
        <input type="password" class="edit-input" id="confirmPass" placeholder="Confirm new password">
        <button class="btn" onclick="savePassword()">Update Password</button>
        <div class="success-msg" id="passSuccess">‚úì Password updated!</div>
      </div>
    </div>
  </div>

  <!-- Actions -->
  <button class="btn" onclick="window.location.href='dashboard.html'">‚Üê Back to Dashboard</button>
  <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>

  <div class="footer">
    <div class="footer-line">¬© 2024 QuizHub | BSIT - WMAD</div>
    <div class="footer-line">Isabela State University</div>
    <div class="footer-line">Made with ‚ù§Ô∏è by Christopher, Ashlee & Marjorie</div>
    <div class="footer-line" style="margin-top:10px;opacity:0.6;">Version 1.0.0</div>
  </div>
</div>

<script src="quiz.js"></script>
<script>
requireLogin();

// Load current settings
const userData = getCurrentUserData();
document.getElementById('currentName').innerText = userData ? userData.name : '-';
document.getElementById('soundEffects').checked = SoundSystem.settings.soundEffects;
document.getElementById('bgMusic').checked = SoundSystem.settings.backgroundMusic;

function toggleSoundEffects() {
  const enabled = document.getElementById('soundEffects').checked;
  SoundSystem.setSoundEffects(enabled);
  if (enabled) SoundSystem.click();
}

function toggleBgMusic() {
  const enabled = document.getElementById('bgMusic').checked;
  SoundSystem.setBackgroundMusic(enabled);
}

function toggleEditName() {
  const section = document.getElementById('editNameSection');
  section.classList.toggle('show');
  if (section.classList.contains('show')) {
    document.getElementById('newName').value = userData ? userData.name : '';
    document.getElementById('newName').focus();
  }
}

function toggleEditPassword() {
  const section = document.getElementById('editPasswordSection');
  section.classList.toggle('show');
  if (section.classList.contains('show')) {
    document.getElementById('currentPass').focus();
  }
}

function saveName() {
  const newName = document.getElementById('newName').value;
  if (updateUserName(newName)) {
    document.getElementById('currentName').innerText = newName;
    document.getElementById('nameSuccess').style.display = 'block';
    SoundSystem.correct();
    setTimeout(() => {
      document.getElementById('editNameSection').classList.remove('show');
      document.getElementById('nameSuccess').style.display = 'none';
    }, 1500);
  }
}

function savePassword() {
  const current = document.getElementById('currentPass').value;
  const newP = document.getElementById('newPass').value;
  const confirm = document.getElementById('confirmPass').value;
  if (updatePassword(current, newP, confirm)) {
    document.getElementById('passSuccess').style.display = 'block';
    document.getElementById('currentPass').value = '';
    document.getElementById('newPass').value = '';
    document.getElementById('confirmPass').value = '';
    SoundSystem.correct();
    setTimeout(() => {
      document.getElementById('editPasswordSection').classList.remove('show');
      document.getElementById('passSuccess').style.display = 'none';
    }, 1500);
  }
}

function logout() {
  localStorage.removeItem('sn_current');
  SoundSystem.stopBgMusic();
  window.location.href = 'index.html';
}
</script>
</body>
</html>

